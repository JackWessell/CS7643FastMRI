The code in this file is from https://github.com/CIRS-Girona/s3Tseg/blob/main/utils/utils.py 
and is used in their image-to-image convolutional vision transformer. All credit goes to the original authors.